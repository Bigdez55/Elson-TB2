{
  "timestamp": "2025-07-16T04:11:54.138226",
  "database_tests": {
    "basic_connectivity": {
      "status": "PASSED",
      "details": "Database connection successful",
      "timestamp": "2025-07-16T04:11:54.139358"
    },
    "file_access": {
      "status": "PASSED",
      "details": "Database file exists, size: 0 bytes",
      "timestamp": "2025-07-16T04:11:54.139385"
    },
    "users_table_exists": {
      "status": "FAILED",
      "details": "Users table not found",
      "timestamp": "2025-07-16T04:11:54.139719"
    },
    "redis_connectivity": {
      "status": "FAILED",
      "details": "Error 111 connecting to localhost:6379. Connection refused.",
      "timestamp": "2025-07-16T04:11:55.121501"
    },
    "connection_pool": {
      "status": "PASSED",
      "details": "Successfully created and closed 5 connections",
      "timestamp": "2025-07-16T04:11:55.128615"
    },
    "existing_users_check": {
      "status": "FAILED",
      "details": "(sqlite3.OperationalError) no such table: users\n[SQL: SELECT users.id AS users_id, users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.role AS users_role, users.birthdate AS users_birthdate, users.risk_tolerance AS users_risk_tolerance, users.trading_style AS users_trading_style, users.is_active AS users_is_active, users.is_verified AS users_is_verified, users.is_superuser AS users_is_superuser, users.two_factor_enabled AS users_two_factor_enabled, users.failed_login_attempts AS users_failed_login_attempts, users.account_locked_until AS users_account_locked_until, users.password_last_changed AS users_password_last_changed, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_login AS users_last_login \nFROM users]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)",
      "timestamp": "2025-07-16T04:11:55.129469"
    }
  },
  "auth_tests": {
    "password_hashing": {
      "status": "PASSED",
      "details": "Password hashed successfully, length: 60",
      "timestamp": "2025-07-16T04:11:54.511868"
    },
    "password_verification": {
      "status": "PASSED",
      "details": "Password verification successful",
      "timestamp": "2025-07-16T04:11:54.775733"
    },
    "password_rejection": {
      "status": "PASSED",
      "details": "Wrong password correctly rejected",
      "timestamp": "2025-07-16T04:11:55.038872"
    },
    "jwt_creation": {
      "status": "PASSED",
      "details": "JWT token created, length: 220",
      "timestamp": "2025-07-16T04:11:55.043369"
    },
    "jwt_verification": {
      "status": "PASSED",
      "details": "JWT token verified, payload: {'sub': 'test@example.com', 'exp': 1753330315, 'jti': '38006478-567a-4c9c-8bfb-afb8f2cb2a87', 'type': 'access'}",
      "timestamp": "2025-07-16T04:11:55.043784"
    },
    "jwt_expiration": {
      "status": "PASSED",
      "details": "Expired token correctly rejected",
      "timestamp": "2025-07-16T04:11:55.044190"
    },
    "user_registration": {
      "status": "FAILED",
      "details": "(sqlite3.OperationalError) no such table: users\n[SQL: SELECT users.id AS users_id, users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.role AS users_role, users.birthdate AS users_birthdate, users.risk_tolerance AS users_risk_tolerance, users.trading_style AS users_trading_style, users.is_active AS users_is_active, users.is_verified AS users_is_verified, users.is_superuser AS users_is_superuser, users.two_factor_enabled AS users_two_factor_enabled, users.failed_login_attempts AS users_failed_login_attempts, users.account_locked_until AS users_account_locked_until, users.password_last_changed AS users_password_last_changed, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_login AS users_last_login \nFROM users \nWHERE users.email = ?\n LIMIT ? OFFSET ?]\n[parameters: ('test_user_1752639115.0442@example.com', 1, 0)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)",
      "timestamp": "2025-07-16T04:11:55.117603"
    },
    "user_login": {
      "status": "FAILED",
      "details": "(sqlite3.OperationalError) no such table: users\n[SQL: SELECT users.id AS users_id, users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.role AS users_role, users.birthdate AS users_birthdate, users.risk_tolerance AS users_risk_tolerance, users.trading_style AS users_trading_style, users.is_active AS users_is_active, users.is_verified AS users_is_verified, users.is_superuser AS users_is_superuser, users.two_factor_enabled AS users_two_factor_enabled, users.failed_login_attempts AS users_failed_login_attempts, users.account_locked_until AS users_account_locked_until, users.password_last_changed AS users_password_last_changed, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_login AS users_last_login \nFROM users \nWHERE users.email = ?\n LIMIT ? OFFSET ?]\n[parameters: ('login_test_1752639115.117621@example.com', 1, 0)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)",
      "timestamp": "2025-07-16T04:11:55.121210"
    }
  },
  "security_tests": {
    "rate_limiting": {
      "status": "FAILED",
      "details": "(sqlite3.OperationalError) no such table: users\n[SQL: SELECT users.id AS users_id, users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.role AS users_role, users.birthdate AS users_birthdate, users.risk_tolerance AS users_risk_tolerance, users.trading_style AS users_trading_style, users.is_active AS users_is_active, users.is_verified AS users_is_verified, users.is_superuser AS users_is_superuser, users.two_factor_enabled AS users_two_factor_enabled, users.failed_login_attempts AS users_failed_login_attempts, users.account_locked_until AS users_account_locked_until, users.password_last_changed AS users_password_last_changed, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_login AS users_last_login \nFROM users \nWHERE users.email = ?\n LIMIT ? OFFSET ?]\n[parameters: ('rate_test_1752639115.121512@example.com', 1, 0)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)",
      "timestamp": "2025-07-16T04:11:55.127286"
    },
    "secret_key_strength": {
      "status": "PASSED",
      "details": "Secret key length: 36",
      "timestamp": "2025-07-16T04:11:55.128634"
    },
    "default_secret_key": {
      "status": "FAILED",
      "details": "Using default secret key - security risk!",
      "timestamp": "2025-07-16T04:11:55.128637"
    },
    "token_expiration": {
      "status": "PASSED",
      "details": "Token expiration: 11520 minutes",
      "timestamp": "2025-07-16T04:11:55.128642"
    },
    "cors_configuration": {
      "status": "PASSED",
      "details": "CORS properly configured: ['http://localhost:3000', 'http://localhost:8000', 'https://localhost:3000', 'https://localhost:8000']",
      "timestamp": "2025-07-16T04:11:55.128651"
    },
    "2fa_database_ready": {
      "status": "FAILED",
      "details": "Two-factor authentication field missing from database",
      "timestamp": "2025-07-16T04:11:55.129824"
    }
  },
  "issues": [
    "database_tests.users_table_exists: Users table not found",
    "auth_tests.user_registration: (sqlite3.OperationalError) no such table: users\n[SQL: SELECT users.id AS users_id, users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.role AS users_role, users.birthdate AS users_birthdate, users.risk_tolerance AS users_risk_tolerance, users.trading_style AS users_trading_style, users.is_active AS users_is_active, users.is_verified AS users_is_verified, users.is_superuser AS users_is_superuser, users.two_factor_enabled AS users_two_factor_enabled, users.failed_login_attempts AS users_failed_login_attempts, users.account_locked_until AS users_account_locked_until, users.password_last_changed AS users_password_last_changed, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_login AS users_last_login \nFROM users \nWHERE users.email = ?\n LIMIT ? OFFSET ?]\n[parameters: ('test_user_1752639115.0442@example.com', 1, 0)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)",
    "auth_tests.user_login: (sqlite3.OperationalError) no such table: users\n[SQL: SELECT users.id AS users_id, users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.role AS users_role, users.birthdate AS users_birthdate, users.risk_tolerance AS users_risk_tolerance, users.trading_style AS users_trading_style, users.is_active AS users_is_active, users.is_verified AS users_is_verified, users.is_superuser AS users_is_superuser, users.two_factor_enabled AS users_two_factor_enabled, users.failed_login_attempts AS users_failed_login_attempts, users.account_locked_until AS users_account_locked_until, users.password_last_changed AS users_password_last_changed, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_login AS users_last_login \nFROM users \nWHERE users.email = ?\n LIMIT ? OFFSET ?]\n[parameters: ('login_test_1752639115.117621@example.com', 1, 0)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)",
    "database_tests.redis_connectivity: Error 111 connecting to localhost:6379. Connection refused.",
    "security_tests.rate_limiting: (sqlite3.OperationalError) no such table: users\n[SQL: SELECT users.id AS users_id, users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.role AS users_role, users.birthdate AS users_birthdate, users.risk_tolerance AS users_risk_tolerance, users.trading_style AS users_trading_style, users.is_active AS users_is_active, users.is_verified AS users_is_verified, users.is_superuser AS users_is_superuser, users.two_factor_enabled AS users_two_factor_enabled, users.failed_login_attempts AS users_failed_login_attempts, users.account_locked_until AS users_account_locked_until, users.password_last_changed AS users_password_last_changed, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_login AS users_last_login \nFROM users \nWHERE users.email = ?\n LIMIT ? OFFSET ?]\n[parameters: ('rate_test_1752639115.121512@example.com', 1, 0)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)",
    "security_tests.default_secret_key: Using default secret key - security risk!",
    "database_tests.existing_users_check: (sqlite3.OperationalError) no such table: users\n[SQL: SELECT users.id AS users_id, users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.role AS users_role, users.birthdate AS users_birthdate, users.risk_tolerance AS users_risk_tolerance, users.trading_style AS users_trading_style, users.is_active AS users_is_active, users.is_verified AS users_is_verified, users.is_superuser AS users_is_superuser, users.two_factor_enabled AS users_two_factor_enabled, users.failed_login_attempts AS users_failed_login_attempts, users.account_locked_until AS users_account_locked_until, users.password_last_changed AS users_password_last_changed, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_login AS users_last_login \nFROM users]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)",
    "security_tests.2fa_database_ready: Two-factor authentication field missing from database"
  ],
  "recommendations": [
    "Database connectivity issues detected - check connection strings and database file permissions",
    "Authentication system issues detected - review JWT configuration and password hashing",
    "CRITICAL: Change default secret key in production",
    "Consider migrating to PostgreSQL for production use",
    "Implement comprehensive logging for security events",
    "Set up monitoring for failed authentication attempts",
    "Consider implementing account lockout policies",
    "Add email verification for new user registrations",
    "Implement password complexity requirements",
    "Set up regular security audits and penetration testing"
  ]
}